<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>ScalaCheck</title>
    <link href="./css/opensans-fonts.css"                          type="text/css" rel="stylesheet" />
    <link href="./css/bootstrap.min.css"                           type="text/css" rel="stylesheet" />
    <link href="./css/font-awesome.min.css"                        type="text/css" rel="stylesheet" />
    <link href="./css/prettify.css"                                type="text/css" rel="stylesheet" />
    <link href="./css/tabber.css"                                  type="text/css" rel="stylesheet" />
    <link href="./css/tipuesearch.css"                             type="text/css" rel="stylesheet" />
    <link href="./css/specs2.css"                                  type="text/css" rel="stylesheet" />
    <link href="./css/specs2-user.css"                             type="text/css" rel="stylesheet" />

    <script src="./javascript/jquery.js"                           type="text/javascript"></script>
    <script src="./javascript/jquery.jstree.js"                    type="text/javascript"></script>
    <script src="./javascript/tabber.js"                           type="text/javascript"></script>
    <script src="./javascript/tabber_start.js"                     type="text/javascript"></script>
    <script src="./javascript/prettify.js"                         type="text/javascript"></script>
    <script src="./javascript/specs2.js"                           type="text/javascript"></script>
    <script src="./javascript/specs2-user.js"                      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_set.js"      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_contents.js" type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch.min.js"      type="text/javascript"></script>

</head>
<body onload="prettyPrint()">

<div class="container">

<div class="col-md-2 sidebar-outer">
<div class="col-md-2 fixed">

<!-- search box -->
<div class="search-box">
  <form action="search.html">
    <input type="text" name="q" id="tipue_search_input" autocomplete="off" required>
  </form>
</div>

<!-- table of contents -->
<div id="tree"><ul>
                <li id="org-specs2-guide-consoleoutput"><a href="org.specs2.guide.ConsoleOutput.html" title="Console output">Console output</a>
      <ul><ul><li><a href="org.specs2.guide.ConsoleOutput.html#show-only" title="Show only">Show only</a>
          
        </li><li><a href="org.specs2.guide.ConsoleOutput.html#stacktracefilter" title="StackTraceFilter">StackTraceFilter</a>
          
        </li><li><a href="org.specs2.guide.ConsoleOutput.html#diffs" title="Diffs">Diffs</a>
          
        </li><li><a href="org.specs2.guide.ConsoleOutput.html#colors" title="Colors">Colors</a>
          
        </li></ul></ul>
      <ul>
                    
                  </ul>
    </li>
              </ul></div><script>$(function () { $('#tree').jstree({'core':{'initially_open':['org-specs2-guide-usescalacheck'], 'animation':200}, 'themes' : {'theme': 'default','url': './css/themes/default/style.css'}, 'plugins':['themes', 'html_data']}); });</script>

</div>
</div>


<div class="col-md-10">
<h1>ScalaCheck</h1>
<div id="tipue_search_content"></div>

<p>A clever way of creating expectations in <s2>specs2</s2> is to use the <a href="https://github.com/rickynils/scalacheck">ScalaCheck</a> library.</p>
<p>To declare ScalaCheck properties you first need to extend the <code class="prettyprint">org.specs2.ScalaCheck</code> trait. Then you can pass functions returning any kind of <code class="prettyprint">Result</code> (<code class="prettyprint">Boolean</code>, <code class="prettyprint">Result</code>, <code class="prettyprint">MatchResult</code> or a ScalaCheck <code class="prettyprint">Prop</code>) to the <code class="prettyprint">prop</code> method and use the resulting <code class="prettyprint">Prop</code> as your example body:</p>
<pre><code class="prettyprint">s2&quot;addition and multiplication are related ${ prop { (a: Int) =&gt; a + a == 2 * a } }&quot;</code></pre>
<p>The function that is checked can either return:</p>
<pre><code class="prettyprint">// a Boolean
s2&quot;addition and multiplication are related ${ prop { (a: Int) =&gt; a + a == 2 * a } }&quot;

// a MatchResult
s2&quot;addition and multiplication are related ${ prop { (a: Int) =&gt; a + a must_== 2 * a } }&quot;

// a Prop
s2&quot;addition and multiplication are related ${ prop { (a: Int) =&gt; (a &gt; 0) ==&gt; (a + a must_== 2 * a) } }&quot;</code></pre>
<p>Note that if you pass functions using <code class="prettyprint">MatchResult</code>s you will get better failure messages than just using boolean expressions.</p>
<p>By default the properties created with <code class="prettyprint">prop</code> will be shrinking counter-examples. But as you will see below there lots of different ways to parameterize ScalaCheck properties in specs2, including declaring if shrinking must be done.</p>
<h3 id="arbitrary-instances">Arbitrary instances</h3>
<p>ScalaCheck requires an implicit <code class="prettyprint">Arbitrary[T]</code> instance for each parameter of type <code class="prettyprint">T</code> used in a property. If you rather want to pick up a specific <code class="prettyprint">Arbitrary[T]</code> for a given property argument you can modify the <code class="prettyprint">prop</code> with to use another <code class="prettyprint">Arbitrary</code> instance:</p>
<pre><code class="prettyprint">s2&quot;&quot;&quot;
  a simple property       $ex1
  a more complex property $ex2
&quot;&quot;&quot;

def abStringGen = (Gen.oneOf(&quot;a&quot;, &quot;b&quot;) |@| Gen.oneOf(&quot;a&quot;, &quot;b&quot;))(_+_)

implicit def abStrings: Arbitrary[String] =
  Arbitrary(abStringGen)

def ex1 = prop((s: String) =&gt; s must contain(&quot;a&quot;) or contain(&quot;b&quot;)).setArbitrary(abStrings)

// use the setArbitrary&lt;n&gt; method for the nth argument
def ex2 = prop((s1: String, s2: String) =&gt; (s1+s2) must contain(&quot;a&quot;) or contain(&quot;b&quot;)).
            setArbitrary1(abStrings).setArbitrary2(abStrings)</code></pre>
<p>It is also possible to pass a <code class="prettyprint">Gen[T]</code> instance instead of an <code class="prettyprint">Arbitrary[T]</code>:</p>
<pre><code class="prettyprint">val abStringGen = (Gen.oneOf(&quot;a&quot;, &quot;b&quot;) |@| Gen.oneOf(&quot;a&quot;, &quot;b&quot;))(_+_)

def ex1 = prop((s: String) =&gt; s must contain(&quot;a&quot;) or contain(&quot;b&quot;)).setGen(abStringGen)</code></pre>
<h3 id="with-shrink-pretty">With Shrink / Pretty</h3>
<p>Specific Shrink and Pretty instances can also be specified at the property level:</p>
<pre><code class="prettyprint">val shrinkString: Shrink[String] = ???

// set a specific shrink instance on the second parameter
prop((s1: String, s2: String) =&gt; s1.nonEmpty or s2.nonEmpty).setShrink2(shrinkString)

// set a specific pretty instance
prop((s: String) =&gt; s must contain(&quot;a&quot;) or contain(&quot;b&quot;)).setPretty((s: String) =&gt;
  Pretty((prms: Pretty.Params) =&gt; if (prms.verbosity &gt;= 1) s.toUpperCase else s))

// or simply if you don&#39;t use the Pretty parameters
prop((s: String) =&gt; s must contain(&quot;a&quot;) or contain(&quot;b&quot;)).pretty((_: String).toUpperCase)</code></pre>
<h3 id="contexts">Contexts</h3>
<p>ScalaCheck properties are sometimes used to test stateful applications rather than pure functions. For example you want to test that a function is writing files somewhere and you would like those files to be deleted after each property execution:</p>
<pre><code class="prettyprint">def createFile(f: File): Unit = ???
def deleteTmpDir: Unit = ???

prop { f: File =&gt;
  createFile(f)
  f.exists
}.after(deleteTmpDir) // before and beforeAfter can also be used there</code></pre>
<p>You can also “prepare” the property to be tested based on the generated arguments:</p>
<pre><code class="prettyprint">def createFile(directory: File, f: File): Unit = ???
// this method will keep the arguments intact but can
// have a side-effect to prepare the system
def setupDirectoryAndFile = (directory: File, file: File) =&gt; (directory, file)

prop { (directory: File, f: File) =&gt;
  createFile(directory, f)
  f.exists
}.prepare(setupDirectoryAndFile)</code></pre>
<p>Note that there is a way to <a href="https://github.com/rickynils/scalacheck/wiki/User-Guide#stateful-testing">model stateful systems</a> with ScalaCheck which goes beyond the simple setup/teardown testing done here.</p>
<h3 id="test-properties">Test properties</h3>
<h4 id="default-values">Default values</h4>
<p>ScalaCheck test generation can be tuned with a few properties. If you want to change the default settings, you have to use implicit values:</p>
<pre><code class="prettyprint">implicit val params = Parameters(minTestsOk = 20) // add &quot;.verbose&quot; to get additional console printing</code></pre>
<p>The parameters you can modify are:</p>
<table>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code class="prettyprint">minTestsOk</code></td>
<td align="left"><code class="prettyprint">100</code></td>
<td align="left">minimum of tests which must be ok before the property is ok</td>
</tr>
<tr class="even">
<td align="left"><code class="prettyprint">maxDiscardRatio</code></td>
<td align="left"><code class="prettyprint">5.0f</code></td>
<td align="left">if the data generation discards too many values, then the property can’t be proven</td>
</tr>
<tr class="odd">
<td align="left"><code class="prettyprint">minSize</code></td>
<td align="left"><code class="prettyprint">0</code></td>
<td align="left">minimum size for the “sized” data generators, like list generators</td>
</tr>
<tr class="even">
<td align="left"><code class="prettyprint">maxSize</code></td>
<td align="left"><code class="prettyprint">100</code></td>
<td align="left">maximum size for the “sized” data generators</td>
</tr>
<tr class="odd">
<td align="left"><code class="prettyprint">workers</code></td>
<td align="left"><code class="prettyprint">1</code></td>
<td align="left">number of threads checking the property</td>
</tr>
<tr class="even">
<td align="left"><code class="prettyprint">rng</code></td>
<td align="left"><code class="prettyprint">new java.util.Random</code></td>
<td align="left">the random number generator</td>
</tr>
<tr class="odd">
<td align="left"><code class="prettyprint">callback</code></td>
<td align="left"></td>
<td align="left">a ScalaCheck TestCallback (see the <a href="http://www.scalacheck.org">ScalaCheck documentation</a>)</td>
</tr>
<tr class="even">
<td align="left"><code class="prettyprint">loader</code></td>
<td align="left"></td>
<td align="left">a custom classloader (see the <a href="http://www.scalacheck.org">ScalaCheck documentation</a>)</td>
</tr>
<tr class="odd">
<td align="left"><code class="prettyprint">prettyParams</code></td>
<td align="left"></td>
<td align="left">a <code class="prettyprint">Pretty.Params</code> instance to set the verbosity level when displaying <code class="prettyprint">Pretty</code> instances</td>
</tr>
</tbody>
</table>
<h4 id="property-level">Property level</h4>
<p>It is also possible to specifically set the execution parameters on a given property:</p>
<pre><code class="prettyprint">class ScalaCheckSpec extends mutable.Specification with ScalaCheck {
  &quot;this is a specific property&quot; &gt;&gt; prop { (a: Int, b: Int) =&gt;
    (a + b) must_== (b + a)
  }.set(minTestsOk = 200, workers = 3) // use &quot;display&quot; instead of &quot;set&quot; for additional console printing
}</code></pre>
<p>You can also set the random generator that is used in all the ScalaCheck generators:</p>
<pre><code class="prettyprint">case class MyRandomGenerator() extends java.util.Random {
  // implement a deterministic generator for example
}

&quot;this is a specific property&quot; ! prop { (a: Int, b: Int) =&gt;
  (a + b) must_== (b + a)
}.set(rng = MyRandomGenerator(), minTestsOk = 200, workers = 3)</code></pre>
<h4 id="command-line">Command-line</h4>
<p>Some properties can be overridden from the command line</p>
<table>
<thead>
<tr class="header">
<th align="left">Parameter</th>
<th align="left">Command line</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><code class="prettyprint">minTestsOk</code></td>
<td align="left"><code class="prettyprint">scalacheck.mintestsok</code></td>
</tr>
<tr class="even">
<td align="left"><code class="prettyprint">maxDiscardRatio</code></td>
<td align="left"><code class="prettyprint">scalacheck.maxdiscardratio</code></td>
</tr>
<tr class="odd">
<td align="left"><code class="prettyprint">minSize</code></td>
<td align="left"><code class="prettyprint">scalacheck.minsize</code></td>
</tr>
<tr class="even">
<td align="left"><code class="prettyprint">maxSize</code></td>
<td align="left"><code class="prettyprint">scalacheck.maxsize</code></td>
</tr>
<tr class="odd">
<td align="left"><code class="prettyprint">workers</code></td>
<td align="left"><code class="prettyprint">scalacheck.workers</code></td>
</tr>
<tr class="even">
<td align="left"><code class="prettyprint">verbose</code></td>
<td align="left"><code class="prettyprint">scalacheck.verbose</code></td>
</tr>
</tbody>
</table>
<h4 id="expectations">Expectations</h4>
<p>By default, a successful example using a <code class="prettyprint">Prop</code> will be reported as 1 success and 100 (or <code class="prettyprint">minTestsOk</code>) expectations. If you don’t want the number of expectations to appear in the specification statistics just mix-in your specification the <code class="prettyprint">org.specs2.scalacheck.OneExpectationPerProp</code> trait.</p>
<h3 id="collect-values">Collect values</h3>
<p>It is important to validate that generated values are meaningful. In order to do this you can use <code class="prettyprint">collect</code> to collect values:</p>
<pre><code class="prettyprint">// for a property with just one argument
prop((i: Int) =&gt; i % 2 == 0).collect
// for a property with just 2 arguments
// collect the second value only
prop((i: Int, j: Int) =&gt; i &gt; 0 &amp;&amp; j % 2 == 0).collect2
// collect the second value but map it to something else
prop((i: Int, j: Int) =&gt; i &gt; 0 &amp;&amp; j % 2 == 0).collectArg2((n: Int) =&gt; &quot;the value &quot;+n)
// collect all values and display
prop((i: Int, j: Int) =&gt; i &gt; 0 &amp;&amp; j % 2 == 0).collectAll.verbose</code></pre>
<p>Note that, by default, nothing will be printed on screen unless you set the reporting to <code class="prettyprint">verbose</code> by either:</p>
<ul>
<li>changing the default <code class="prettyprint">Parameters</code></li>
<li>setting <code class="prettyprint">.verbose</code> at the property level</li>
<li>passing <code class="prettyprint">scalacheck.verbose</code> on the command-line</li>
</ul>
<h3 id="equivalence">Equivalence</h3>
<p>The <code class="prettyprint">==&gt;</code> operator in ScalaCheck helps you specify under which conditions a given property is applicable. However it only works one way, you cannot declare that a property must be true “if and only if” some conditions are respected.</p>
<p>With <s2>specs2</s2> and the <code class="prettyprint">org.specs2.execute.ResultImplicits</code> trait you can use the <code class="prettyprint">&lt;==&gt;</code> operator to declare the equivalence of 2 <code class="prettyprint">Results</code>, whether they are properties or booleans or <code class="prettyprint">MatchResults</code>. So you can write:</p>
<pre><code class="prettyprint">// replace 55 with whatever you think &quot;old&quot; is...
prop((i: Int) =&gt; (i &gt;= 18 &amp;&amp; i &lt;= 55) &lt;==&gt; isYoung(i))</code></pre>
</div>

<script>
$(document).ready(function() {
  $('#tipue_search_input').tipuesearch({
    'show': 6
  });
});
</script>
</div>

</body>
</html>