<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Troubleshooting</title>
    <link href="./css/opensans-fonts.css"                          type="text/css" rel="stylesheet" />
    <link href="./css/bootstrap.min.css"                           type="text/css" rel="stylesheet" />
    <link href="./css/font-awesome.min.css"                        type="text/css" rel="stylesheet" />
    <link href="./css/prettify.css"                                type="text/css" rel="stylesheet" />
    <link href="./css/tabber.css"                                  type="text/css" rel="stylesheet" />
    <link href="./css/tipuesearch.css"                             type="text/css" rel="stylesheet" />
    <link href="./css/specs2.css"                                  type="text/css" rel="stylesheet" />
    <link href="./css/specs2-user.css"                             type="text/css" rel="stylesheet" />

    <script src="./javascript/jquery.js"                           type="text/javascript"></script>
    <script src="./javascript/jquery.jstree.js"                    type="text/javascript"></script>
    <script src="./javascript/tabber.js"                           type="text/javascript"></script>
    <script src="./javascript/tabber_start.js"                     type="text/javascript"></script>
    <script src="./javascript/prettify.js"                         type="text/javascript"></script>
    <script src="./javascript/specs2.js"                           type="text/javascript"></script>
    <script src="./javascript/specs2-user.js"                      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_set.js"      type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch_contents.js" type="text/javascript"></script>
    <script src="./javascript/tipuesearch/tipuesearch.min.js"      type="text/javascript"></script>

</head>
<body onload="prettyPrint()">

<div class="container">

<div class="col-md-2 sidebar-outer">
<div class="col-md-2 fixed">

<!-- search box -->
<div class="search-box">
  <form action="search.html">
    <input type="text" name="q" id="tipue_search_input" autocomplete="off" required>
  </form>
</div>

<!-- table of contents -->
<toc/>

</div>
</div>


<div class="col-md-10">
<h1>Troubleshooting</h1>
<div id="tipue_search_content"></div>

<p>This section presents some of the common pitfalls you might face when using <s2>specs2</s2> and Scala</p>
<h3 id="vals-vs-lazy-vals">vals vs lazy vals</h3>
<p>The common symptom here is a <code class="prettyprint">NullPointerException</code> for some attributes of your specification. You can refer to this <a href="http://engineering.tapad.com/blog/2012/11/here-there-be-dragons-dangers-of-initialization-order-in-scala/">link</a> for an explanation of variable initialization in Scala. In the meantime the basic fix is to use a <code class="prettyprint">lazy val</code> instead of a <code class="prettyprint">val</code>.</p>
<h3 id="lost-expectations">Lost expectations</h3>
<p>You might expect the following specification to fail:</p>
<pre class="prettyprint"><code class="prettyprint">class ShouldItFail extends Specification { def is = s2&quot;&quot;&quot;
  Should this example fail? $e1
&quot;&quot;&quot;
  def e1 = {
    1 must_== 100000 // do you expect this to fail
    10 must_== 10
  }
}</code></pre>
<p>However, as explained in <link class="ok"><a href="org.specs2.guide.Structure.html" tooltip="" class="ok">Structure</a></link> - Thrown expectations, the first expectation is lost because, by default, no exceptions are thrown in an acceptance specification. In that case you can either:</p>
<ul>
<li>create 2 examples having one expectation each</li>
<li>mix-in the <code class="prettyprint">ThrownExpectations</code> trait</li>
</ul>
<h3 id="no-evidence-parameter-for-asresult">No evidence parameter for AsResult</h3>
<p>Here is a mysterious <code class="prettyprint">AsResult</code> message</p>
<pre><code class="prettyprint">class MysteriousAsResult extends mutable.Specification {
  &quot;Try this&quot; in {
    1 must_== 1
    println(&quot;this is ok, right?&quot;)
  }
}

[error] could not find implicit value for evidence parameter of type org.specs2.execute.AsResult[Unit]</code></pre>
<p>What’s happening? Each example must return a value of type <code class="prettyprint">T</code> where <code class="prettyprint">T</code> has an <code class="prettyprint">AsResult</code> instance. This is the case if <code class="prettyprint">T</code> is a <code class="prettyprint">Boolean</code>, a <code class="prettyprint">MatchResult</code>, a ScalaCheck <code class="prettyprint">Prop</code> etc… (see <link class="ok"><a href="org.specs2.guide.AsResultTypeclass.html" tooltip="" class="ok">AsResult typeclass</a></link>). In the class above the return value is <code class="prettyprint">Unit</code> which doesn’t have an <code class="prettyprint">AsResult</code> instance.</p>
<p>To fix this you can either:</p>
<ul>
<li>either return <code class="prettyprint">ok</code> after <code class="prettyprint">println</code></li>
<li>create your own matcher (see <link class="ok"><a href="org.specs2.guide.Matchers.html" tooltip="" class="ok">Matchers</a></link>) and make sure you have a proper expectation for your example</li>
<li>add an <code class="prettyprint">AsResult[Unit]</code> instance like this</li>
</ul>
<pre class="prettyprint"><code class="prettyprint">implicit def unitAsResult: AsResult[Unit] = new AsResult[Unit] {
  def asResult(r: =&gt;Unit) =
    ResultExecution.execute(r)(_ =&gt; Success())
}</code></pre>
<h3 id="type-mismatch">Type mismatch</h3>
<p>This is also a tricky one, showing the limitations of embedding a pseudo-natural language into a programming language:</p>
<pre><code class="prettyprint">class Inference extends mutable.Specification {
  &quot;It doesn&#39;t mean what you think it does&quot; &gt;&gt; {
    List(1, 2, 3) must not beNull
    List(1, 2) must have size(2)
  }
}

[error] type mismatch;
[error]  found   : List[Int]
[error]  required: org.specs2.matcher.Matcher[List[Int]]
[error]     List(1, 2) must have size(2)
[error]         ^</code></pre>
<p>The first statement is parsed as <code class="prettyprint">issue.must(not).beNull</code> as if <code class="prettyprint">beNull</code> was a method expecting an argument on the next line (this is well explained in this <a href="http://stackoverflow.com/questions/14336699/specs2-multiple-matcher-expressions-unit-specification">StackOverflow question</a>).</p>
<p>The possible fixes are:</p>
<ul>
<li>use parentheses around <code class="prettyprint">beNull</code>, like this: <code class="prettyprint">not(beNull)</code></li>
<li>use a semi-column after the first line</li>
</ul>
</div>

<script>
$(document).ready(function() {
  $('#tipue_search_input').tipuesearch({
    'show': 6
  });
});
</script>
</div>

</body>
</html>